<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <title>Creating a User for RQ | iQmetrix Developer Portal</title>
    <link href="../../css/screen.css" rel="stylesheet" media="screen" />
    <link href="../../css/print.css" rel="stylesheet" media="print" />
    <script src="../../js/all.js"></script>

    <link rel="shortcut icon" href="../../images/favicon.ico" type="image/x-icon">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

    <body class="api api_catalog2 api_catalog2_index" data-languages="[&quot;javascript&quot;,&quot;shell&quot;,&quot;csharp&quot;,&quot;java&quot;,&quot;ruby&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../../images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="../../images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
              <a href="#" data-language-name="shell">cURL</a>
              <a href="#" data-language-name="csharp">c#</a>
              <a href="#" data-language-name="java">java</a>
              <a href="#" data-language-name="ruby">ruby</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
    </div>

    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">

      
<h2 id="overview">Overview</h2>

<p>This guide is intended to walk you through the process of adding a employee from your system into RQ as an employee (user) and assigning it to a location with a security role.</p>

<p>Users in the User Manager represent Employee accounts from the Entity Store that are used to access data within RQ. To learn more about this interaction, see <a href="/user-manager/">User Manager</a>.</p>

<p>The following APIs will be covered in this guide:</p>

<ul>
  <li>Authentication</li>
  <li>User Manager</li>
  <li>Company Tree</li>
  <li>Security Roles</li>
</ul>

<h4 id="who-is-this-guide-for">Who Is This Guide For?</h4>

<p>The intended audience for this guide are developers who are integrating employees within their system into the Entity Store program.</p>

<h4 id="prerequisites">Prerequisites</h4>

<p>To use this guide, the following steps must be completed:</p>

<ul>
  <li>You must have <strong>RQ v5.12</strong> or later (supports two-way communication between APIs and RQ)</li>
  <li>You must have your <strong>onboarding package</strong> from iQmetrix, which includes your access credentials and environments</li>
  <li>Your Company Tree in RQ, representing company structure (stores, groups, divisions, etc.) must be created</li>
</ul>

<div class="alert alert-success" role="alert"><i class="fa fa-check-square-o"></i> <b>Tip: </b>If the above steps are not complete or you are not sure, please contact <a href="mailto:?subject=RQ User Support">API Support</a>.</div>

<h3 id="before-you-begin">Before You Begin</h3>
<p>Before you can create and assign a User, you will need to know:</p>

<ul>
  <li><strong>Who</strong> is being assigned the role, the User</li>
  <li><strong>What</strong> access the user is granted in the company, the Security Role</li>
  <li><strong>Where</strong> the user is located in the company, the Location</li>
</ul>

<h2 id="step-1---authenticating">Step 1 - Authenticating</h2>

<p>In order to make authorized requests to iQmetrix APIs, you need an <a href="/api/glossary/#access-token">Access Token</a>.</p>

<p>See the table below for different ways of getting an Access Token.</p>

<p><br />
<strong>Table 1:</strong> Methods for Obtaining an Access Token</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">If…</th>
      <th style="text-align: left">Then…</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">You do not have an Access Token</td>
      <td style="text-align: left">See <a href="/api/authentication/#obtaining-an-access-token">Obtaining an Access Token</a></td>
    </tr>
    <tr>
      <td style="text-align: left">You have an Access Token, but it is close to expiring</td>
      <td style="text-align: left">See <a href="/api/authentication/#refreshing-an-access-token">Refreshing an Access Token</a></td>
    </tr>
  </tbody>
</table>

<p>The token is placed in the <code class="highlighter-rouge">Authorization</code> header of requests to iQmetrix APIs, prefixed by the word <code class="highlighter-rouge">Bearer</code>.</p>

<h5 id="example-request">Example Request</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>Authorization: Bearer (Access Token)
</code></pre>
</div>

<h2 id="step-2---creating-the-user">Step 2 - Creating the User</h2>

<p>The goal of this step is to create an Employee profile in the Entity Store. Our platform performs synchronizations to push these users into their respective companies in RQ.</p>

<p>The <code class="highlighter-rouge">ParentEntityId</code> (Company ID from Entity Store) is required to import the employee.</p>

<p>Ensure that you mark down the <code class="highlighter-rouge">Id</code> from the response, to be used in the later steps.</p>

<h3 id="21-adding-a-user">2.1 Adding a User</h3>

<p>Should you omit the <code class="highlighter-rouge">password</code> field in this API call (e.g. a brand new employee) you will need to force a <a href="#setting-up-a-temporary-password">temporary password</a>. Otherwise, the user will not be able to log into RQ. Ensure there is a <code class="highlighter-rouge">ParentEntityId</code>, as this is the Company ID.</p>

<p>To import a user from your existing system, see <a href="/api/user-manager/#importing-an-existing-user">Importing an Existing User</a>.</p>

<p>In RQ, the JSON request would appear similar to the figure below.</p>

<p><br />
<strong>Figure 1:</strong> Displays the RQ results from adding a user.</p>

<p><img src="http://localhost:4006/images/rq-general-details.png" alt="Employee general fields" /></p>

<p><br /></p>

<h5 id="example-request-1">Example Request</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>POST https://usermanagerdemo.iqmetrix.net/v1/Users/importExisting
Authorization: Bearer (Access Token)
Accept: application/json
Content-Type: application/json
{
    "UserName": "johnb@test.com",
    "Password": "samplepassword",
    "Email": "johnb@test.com",
    "FirstName": "John",
    "LastName": "Bates",
    "ParentEntityId": 14146,
    "ClientUserId": "132",
    "JobTitle": "Sales Clerk",
    "Address": {
        "AddressLine1": "1432 Merry View Road",
        "AddressLine2": "",
        "City": "Big Windy",
        "StateCode": "ON",
        "CountryCode": "CA",
        "Zip": "A1A2B2"
    },
    "PhoneNumbers": [
        {
            "Number": "6135550127",
            "Extension": "5532",
            "Type": "Work"
        }
    ]
}
</code></pre>
</div>

<h5 id="example-response">Example Response</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>HTTP 201 Content-Type: application/json
{
    "Password": null,
    "Id": 19760,
    "CorrelationId": null,
    "ClientUserId": "132",
    "FirstName": "John",
    "LastName": "Bates",
    "UserName": "johnb@test.com",
    "Email": "johnb@test.com",
    "IsActive": true,
    "ParentEntityId": 14146,
    "Profiles": [],
    "Picture": null,
    "Address": {
        "AddressLine1": "1432 Merry View Road",
        "AddressLine2": "",
        "City": "Big Windy",
        "StateCode": "ON",
        "CountryCode": "CA",
        "Zip": "A1A2B2"
    },
    "PhoneNumbers": [
        {
            "Number": "6135550127",
            "Extension": "5532",
            "Type": "Work"
        }
    ],
    "JobTitle": "Sales Clerk",
    "Version": 1
}
</code></pre>
</div>

<h3 id="22-setting-up-a-temporary-password">2.2 Setting Up a Temporary Password</h3>

<p>If you omitted the password from the previous step, then you must force the user to change their password when logging in for the first time.</p>

<p>To set a temporary password for your user, see <a href="/api/user-manager/#setting-a-temporary-password">Setting a Temporary Password</a></p>

<h5 id="example-request-2">Example Request</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>POST https://usermanagerdemo.iqmetrix.net/v1/Users({UserId})/TemporaryPassword
Authorization: Bearer (Access Token)
Accept: application/json
Content-Type: application/json
{
    "Password": "newpa55word"
}
</code></pre>
</div>

<h5 id="example-response-1">Example Response</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>HTTP 204 Content-Type: application/json
</code></pre>
</div>

<h2 id="step-3-assigning-locations">Step 3 Assigning Locations</h2>

<p>Once you have created a user in the system, the next step is to assign it to a location within your company tree. This ensures that employeee visibility and activity is restricted to that particular location. For more information on Company Tree, see <a href="/company-tree/">Company Tree</a>.</p>

<h3 id="31-getting-company-locations">3.1 Getting Company Locations</h3>

<p>Getting all locations for a company will provide both store information as well as the Location IDs to be used in Step 3.2.</p>

<p>To get a list of locations, see <a href="/api/company-tree/#getting-all-locations-for-a-company">Getting All Locations for a Company</a></p>

<h5 id="example-request-3">Example Request</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>GET https://entitymanagerdemo.iqmetrix.net/v1/Companies({CompanyId})/Locations
Authorization: Bearer (Access Token)
Accept: application/json
</code></pre>
</div>

<h5 id="example-response-2">Example Response</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>HTTP 200 Content-Type: application/json
{
    "Id": 14202,
    "Name": "Dufferin Mall",
    "Description": "This Location is used to clear out discounted inventory",
    "Roles": [
        {
            "Name": "Location"
        }
    ],
    "CreatedUTC": "2015-02-26T00:03:01.372Z",
    "LastModifiedUTC": "2015-02-27T00:03:06.392Z",
    "Area": {
        "Value": 1100,
        "Unit": "SqFt"
    },
    "Address": {
        "AddressLine1": "4970 Hillside Avenue",
        "AddressLine2": "Apt 115",
        "City": "Edmonton",
        "StateCode": "ON",
        "StateName": "Ontario",
        "CountryCode": "CA",
        "CountryName": "Canada",
        "Zip": "P9H 9I4"
    },
    "Attributes": {},
    "ClientEntityId": "123",
    "Contacts": [
        {
            "Name": "John Smith",
            "Description": "Store Manager",
            "PhoneNumbers": [
                {
                    "Description": "Main Line",
                    "Number": "5555555555",
                    "Extension": "1234"
                }
            ]
        }
    ],
    "Geography": {
        "Longitude": -104.612034,
        "Latitude": 50.443559
    },
    "Relationships": [],
    "SortName": "dufferin mall",
    "StoreHours": {
        "Monday": {
            "Open": {
                "Hour": 10,
                "Minute": 0
            },
            "Close": {
                "Hour": 10,
                "Minute": 0
            }
        },
        ...
    },
    "StorePhoneNumbers": [
        {
            "Description": "Main Line",
            "Number": "5555555555",
            "Extension": "1234"
        }
    ],
    "TimeZone": {
        "Id": "Alaskan Standard Time",
        "DaylightSavingTimeEnabled": true
    },
    "Version": 13
}
</code></pre>
</div>

<h3 id="32-assigning-a-location-to-a-user">3.2 Assigning a Location to a User</h3>

<p>The employee from your system will need to be assigned to a location within the company tree in RQ.</p>

<p>To assign a user to a location, see <a href="/api/user-manager/#assigning-a-user-to-a-location">Assigning a User to a Location</a></p>

<p><br />
<strong>Figure 2:</strong> Displays the RQ result from assigning the Location field.</p>

<p><img src="http://localhost:4006/images/rq-user-location.png" alt="rq assigned location" /></p>

<p><br /></p>

<h5 id="example-request-4">Example Request</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>PUT https://usermanagerdemo.iqmetrix.net/v1/Users({UserId})/Locations({LocationId})
Authorization: Bearer (Access Token)
Accept: application/json
Content-Type: application/json
</code></pre>
</div>

<h5 id="example-response-3">Example Response</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>HTTP 204 Content-Type: application/json
</code></pre>
</div>

<h2 id="step-4-assigning-security-roles">Step 4 Assigning Security Roles</h2>

<p>The goal of this step is to ensure that your employee has a security role in RQ that matches their role in your system. If a Security Role is not assigned to a User, then they will not be able to interact with RQ.</p>

<h3 id="41-getting-company-security-roles">4.1 Getting Company Security Roles</h3>

<p>Getting the security roles for a company is the quickest way to retrieve security roles. You are also able to retrieve security roles by Location or Division/Group.</p>

<p>Please note down the Security Role <code class="highlighter-rouge">Id</code> that you will be assigning based on the <code class="highlighter-rouge">EntityId</code> you provided.</p>

<p>For more information, see <a href="/api/security-roles/#getting-all-security-roles-for-an-entity">Getting All Security Roles for an Entity</a></p>

<h5 id="example-request-5">Example Request</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>GET https://usermanagerdemo.iqmetrix.net/v1/Entities({EntityId})/SecurityRoles
Authorization: Bearer (Access Token)
Accept: application/json
</code></pre>
</div>

<h5 id="example-response-4">Example Response</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>HTTP 200 Content-Type: application/json
[
    {
        "Id": 316,
        "Name": "Store Manager"
    }
]
</code></pre>
</div>

<h3 id="42-assigning-a-security-role">4.2 Assigning a Security Role</h3>

<p>The <code class="highlighter-rouge">EntityId</code> assigned to this User would be the Company ID, Location ID, or a Group or Division ID.</p>

<p>For our scenario, we are assigning the security role <code class="highlighter-rouge">Store Manager</code> at this location.</p>

<p>To assign a security role, see <a href="/api/security-roles/#assigning-a-security-role-to-a-user">Assigning a Security Role to a User</a></p>

<p><br />
<strong>Figure 3:</strong> Displays the RQ result from assigning the Security Role field.</p>

<p><img src="http://localhost:4006/images/rq-general-security.png" alt="rq security role" /></p>

<p><br /></p>

<h5 id="example-request-6">Example Request</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>POST https://usermanagerdemo.iqmetrix.net/v1/Users({UserId})/AssignedRoles
Authorization: Bearer (Access Token)
Accept: application/json
Content-Type: application/json
{
    "EntityId": 14159,
    "SecurityRoleId": 316
}
</code></pre>
</div>

<h5 id="example-response-5">Example Response</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>HTTP 201 Content-Type: application/json
{
    "Id": 6548,
    "EntityId": 14159,
    "SecurityRoleId": 316,
    "UserId": 19760
}
</code></pre>
</div>

<h2 id="optional-updating-a-user">(Optional) Updating a User</h2>

<p>This call is <strong>destructive</strong>, and will replace all existing values for the user. When updating a user you must ensure that all previous values are included in the body of the request as well.</p>

<div class="alert alert-success" role="alert"><i class="fa fa-check-square-o"></i> <b>Tip: </b>You cannot change a user's password using this method. To update their password, you must set a temporary password. </div>

<p>A user, its properties, and attributes can be updated anytime by <a href="/api/user-manager/#updating-a-user">Updating a User</a></p>

<h5 id="example-request-7">Example Request</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>PUT https://usermanagerdemo.iqmetrix.net/v1/Users({UserId})
Authorization: Bearer (Access Token)
Accept: application/json
Content-Type: application/json
{
    "Id": 19760,
    "FirstName": "John",
    "LastName": "Bates",
    "UserName": "johnb@kentel.com",
    "Address": {
        "AddressLine1": "1432 Merry View Road",
        "AddressLine2": "",
        "City": "Big Windy",
        "StateCode": "ON",
        "CountryCode": "CA",
        "Zip": "A1A2B2"
    },
    "Attributes": {
        "Department": "Sales"
    },
    "ClientUserId": "132",
    "Email": "johnb@kentel.com",
    "IsActive": true,
    "JobTitle": "Sales Clerk",
    "ParentEntityId": 1,
    "PhoneNumbers": [
        {
            "Number": "6135550127",
            "Extension": "5532",
            "Type": "Work"
        }
    ],
    "Picture": {},
    "Version": 1
}
</code></pre>
</div>

<h5 id="example-response-6">Example Response</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>HTTP 200 Content-Type: application/json
{
    "Id": 2576,
    "FirstName": "John",
    "LastName": "Bates",
    "UserName": "johnb@kentel.com",
    "Address": {
        "AddressLine1": "1432 Merry View Road",
        "AddressLine2": "",
        "City": "Big Windy",
        "StateCode": "ON",
        "CountryCode": "CA",
        "Zip": "A1A2B2"
    },
    "Attributes": {
        "Department": "Sales"
    },
    "ClientUserId": "132",
    "Email": "johnb@kentel.com",
    "IsActive": true,
    "JobTitle": "Sales Clerk",
    "ParentEntityId": 1,
    "PhoneNumbers": [
        {
            "Number": "6135550127",
            "Extension": "5532",
            "Type": "Work"
        }
    ],
    "Picture": {},
    "Version": 1
}
</code></pre>
</div>

<h2 id="optional-terminating-an-employee">(Optional) Terminating an Employee</h2>

<p>An employee can be terminated at anytime by <a href="/api/user-manager/#disabling-a-user">Disabling their user account</a>.</p>

<div class="alert alert-success" role="alert"><i class="fa fa-check-square-o"></i> <b>Tip: </b>This method does not delete the employee.</div>

<div class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> <b>Note: </b>Disabling a User does NOT free up their email address or username to be used to create another User. To free up an email address or username, you must instead update the email or username of the original User to something else. </div>

<h5 id="example-request-8">Example Request</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>DELETE https://usermanagerdemo.iqmetrix.net/v1/Users({UserId})
Authorization: Bearer (Access Token)
</code></pre>
</div>

<h5 id="example-response-7">Example Response</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>HTTP 200 Content-Type: application/json
</code></pre>
</div>


      </div>
      <div class="dark-box">
            <div class="lang-selector">
               <a href="#" data-language-name="javascript">javascript</a>
               <a href="#" data-language-name="shell">cURL</a>
               <a href="#" data-language-name="csharp">c#</a>
               <a href="#" data-language-name="java">java</a>
               <a href="#" data-language-name="ruby">ruby</a>
            </div>
         </div>
    </div>

  </body>


  <!-- the google_analytics_id gets auto inserted from the config file -->


<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-408430-5', 'auto');
    ga('send', 'pageview');
</script>



</html>
